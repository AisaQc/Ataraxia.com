<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tienda Ataraxia</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-gray-200">
  <header>
    <h1 class="text-4xl font-bold text-center mt-6">ATARAXIA PRODUCCIONES</h1>
    <nav class="text-center mt-4">
      <ul class="inline-flex gap-4">
        <li><a href="index.html#inicio">Inicio</a></li>
        <li><a href="index.html#lanzamientos">Lanzamientos</a></li>
        <li><a href="tienda.html">Tienda</a></li>
        <li><a href="https://www.discogs.com/label/2979049-Ataraxia-Producciones" target="_blank" rel="noopener noreferrer">Discogs</a></li>
        <li><a href="index.html#contacto">Contacto</a></li>
      </ul>
    </nav>
  </header>

  <div class="container mx-auto p-4">
    <h2 class="text-3xl font-bold mb-6 text-center">Tienda Ataraxia</h2>

    <div class="flex flex-wrap gap-4 justify-center mb-6">
      <input id="searchInput" type="text" placeholder="Buscar por nombre o características" class="border px-4 py-2 rounded w-full max-w-md text-black" />
      <select id="filterType" class="border px-4 py-2 rounded text-black">
        <option value="">Todos</option>
        <option value="Vinilo">Vinilos</option>
        <option value="CD">CDs</option>
        <option value="Cassette">Cassettes</option>
      </select>
    </div>

    <div id="productList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>

    <div class="fixed bottom-0 right-0 bg-gray-800 shadow-lg p-4 w-full max-w-sm border-t border-gray-600 text-white">
      <h2 class="text-xl font-semibold mb-2">Carrito</h2>
      <ul id="cartItems" class="mb-2"></ul>
      <p class="font-bold">Total: S/ <span id="cartTotal">0.00</span></p>
      <div class="mt-3 space-x-2">
        <button class="bg-purple-600 text-white px-4 py-2 rounded">Pagar con Yape</button>
        <button class="bg-blue-600 text-white px-4 py-2 rounded">Pagar con PayPal</button>
      </div>
    </div>
  </div>

  <footer class="text-center mt-12 p-4 border-t border-gray-700">
    <p>© 2025 Ataraxia Producciones — Sello Independiente</p>
  </footer>

  <script>
    const products = [
      {
        name: 'Combat Noise',
        type: 'Vinilo',
        price: 80,
        description: 'Frontline Offensive Force, 12\" Picture',
        images: [
          'images/AP001_2.jpg',
          'images/AP001_1.jpg',
          'images/AP001.jpg'
        ],
        defaultImage: 'images/AP001_2.jpg'
      },
      {
        name: 'Heretique',
        type: 'Vinilo',
        price: 80,
        description: 'Bestias Hominum, 12\" Incluye bonus track',
        options: ['Edición Clasica', 'Edición Picture'],
        images: {
          'Edición Clasica': 'images/AP011_3.jpg',
          'Edición Picture': 'images/AP011_1.jpg'
        },
        gallery: [
          'images/AP011_4.jpg',
          'images/AP011.jpg',
          'images/AP011_2.jpg',
          'images/AP011_5.jpg'
        ],
        defaultImage: 'images/AP011_4.jpg'
      }
    ];

 const cart = [];

    function renderProducts() {
      const list = document.getElementById('productList');
      const search = document.getElementById('searchInput').value.toLowerCase();
      const filter = document.getElementById('filterType').value;
      list.innerHTML = '';

      products.filter((p) => {
        return (
          (p.name.toLowerCase().includes(search) || p.description.toLowerCase().includes(search)) &&
          (filter === '' || p.type === filter)
        );
      }).forEach((product, i) => {
        const div = document.createElement('div');
        div.className = 'bg-gray-900 p-4 rounded shadow text-white';

        let mainImage = '';
        if (product.images) {
          if (Array.isArray(product.images)) {
            mainImage = product.images[0];
          } else {
            const firstOption = product.options ? product.options[0] : Object.keys(product.images)[0];
            mainImage = product.images[firstOption];
          }
        }

        let imageHtml = `<img src="${mainImage}" id="img-${i}" class="w-full h-72 object-contain bg-black rounded mb-2" alt="${product.name}" />`;

        let galleryHtml = '';
        if (Array.isArray(product.images)) {
          galleryHtml = `
            <div class="flex space-x-2 overflow-x-auto mb-2">
              ${product.images.map(img => `<img src="${img}" class="w-24 h-24 object-contain bg-black rounded cursor-pointer" onclick="document.getElementById('img-${i}').src='${img}'" alt="${product.name}" />`).join('')}
            </div>
          `;
        } else if (product.gallery && Array.isArray(product.gallery)) {
          galleryHtml = `
            <div class="flex space-x-2 overflow-x-auto mb-2">
              ${product.gallery.map(img => `<img src="${img}" class="w-24 h-24 object-contain bg-black rounded cursor-pointer" onclick="document.getElementById('img-${i}').src='${img}'" alt="${product.name}" />`).join('')}
            </div>
          `;
        }

        let html = `
          <h3 class="text-xl font-bold mb-2">${product.name}</h3>
          ${imageHtml}
          ${galleryHtml}
          <p class="text-sm text-gray-400">${product.type}</p>
          <p class="my-2">${product.description}</p>
          <p class="font-semibold">S/ ${product.price.toFixed(2)}</p>
        `;

        if (product.options) {
          html += `<select id="opt-${i}" class="my-2 w-full border rounded px-2 py-1 text-black" onchange="updateImage(${i})">`;
          product.options.forEach((opt) => {
            html += `<option value="${opt}">${opt}</option>`;
          });
          html += `</select>`;
        }

        html += `<button onclick="addToCart(${i})" class="mt-2 bg-green-600 text-white px-4 py-2 rounded w-full">Agregar al carrito</button>`;

        div.innerHTML = html;
        list.appendChild(div);
      });
    }

    function updateImage(index) {
      const select = document.getElementById(`opt-${index}`);
      const selected = select.value;
      const product = products[index];
      if (product.images && typeof product.images === 'object') {
        const image = document.getElementById(`img-${index}`);
        image.src = product.images[selected];
      }
    }

    function addToCart(index) {
      const product = products[index];
      const selectedOption = product.options ? document.getElementById(`opt-${index}`).value : null;
      const name = selectedOption ? `${product.name} - ${selectedOption}` : product.name;

      cart.push({ name, price: product.price });
      updateCart();
    }

    function updateCart() {
      const cartList = document.getElementById('cartItems');
      cartList.innerHTML = '';
      let total = 0;

      cart.forEach((item) => {
        const li = document.createElement('li');
        li.textContent = `${item.name} - S/ ${item.price.toFixed(2)}`;
        cartList.appendChild(li);
        total += item.price;
      });

      document.getElementById('cartTotal').textContent = total.toFixed(2);
    }

    document.getElementById('searchInput').addEventListener('input', renderProducts);
    document.getElementById('filterType').addEventListener('change', renderProducts);

    renderProducts();
  </script>
</body>
</html>
